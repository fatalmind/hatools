.TH hatimerun 1 "@DATE@" "V@VERSION@" "hatools"
.SH NAME
hatimerun \- Run command with a timeout.
.SH SYNOPSIS
.B hatimerun 
[\c
.B -av\c
] [\c
.BI -e " exitcode"\c
] [\c
.BI -k " sig"\c
] \c
.BI -t " [[hh:]mm:]secs"\c
.I " command"\c
[\c
.I args\c
]\c
.br
.B hatimerun
[\c
.B -l\c
|\c
.B -h\c
|\c
.B -?\c
]
.SH DESCRIPTION
Executes
.I command args
with a timeout of
.I [[hh:]mm:]secs
seconds.
If 
.I command
does not terminate before the timeout 
exceeds
.B hatimerun
sends a signal to
.IR command .
.P
.I Command
is started in its own process group; the signal is sent to the process group.
.P 
.B hatimerun
itself will not terminate while
.I command
is running--not even if the timeout occurred.
.B hatimerun
terminates when
.I command
terminates.
.B hatimerun
can be configured to send a sequence of different singals to
.I command
to allow graceful termiation but allow a hard timeout with the KILL signal in the end. See 
.B EXAMPLES
below.
.P
.B hatimerun
itself ignores the following signals to avoid premature termiantion:
TERM, HUP, INT, PIPE, QUIT, USR1 and USR2.
.TP
.BI -t " [[hh:]mm:]secs"
Timeout.
Specifies the time when the signal is sent, if
.I command
did not terminate before.
.br
Multiple occurrences of 
.B -t 
are supported. Every time a specified timeout happens a new signal is sent to the child. See 
.BR EXAMPLES .
.TP
.BI -k " sig"
Specifies the signal that will be sent on timeout.
.br
Multiple occurrences of 
.B -k 
are supported to configure different signals for differnt timeouts. That is, the second
.B -k
signal will be sent on the second timeout, and so on.
In case there are less 
.B -k 
arguments than timeouts 
.RB ( -t ),
.B hatimerun
sends SIGKILL at the additional timeouts. See
.B EXAMPLES
below.
.br
Symbolic as well as numeric signal specifications are accepted. The "magic" signal name
.B NONE
will not send a signal, useful in combination with
.BR -v .

Default:
.B "SIGKILL"\c

.TP
.BI -e " exitcode"
Changes the exitcode returned by
.B hatimerun
on timeout. This code is used as soon as the first timeout has passed, irrespective of the exit status of
.IR command .
.br
Multiple occurrences of 
.B -e 
are supported in connection with multiple occurrences of 
.BR -t .

Default: 
.B 99
.TP
.B -a
Starts 
.B hatimerun 
in the background.
.B hatimerun 
itself exits immediately. The exit code of 
.I command 
is lost.
.TP
.B -l
Prints list of available symbolic signal names on this platform and exits.
.TP
.B -v
Verbose mode. Will print a message, containing the runtime, if the first timeout has passed before
.I command
terminated. Useful in cron to have an e-mail sent if a timeout has passed by.
.br
This option can be paired with the
.B -k NONE
switch to just print an error message on timeout, but don't kill 
.IR command .
.TP
.B -vv
More verbose mode--almost debug mode. Will write a status message on every timeout.
.TP
.B -h | -?
Prints a help screen and exits.
.SH "RETURN VALUE"
If the command terminates normally before the first timeout happened, 
On success
.B hatimerun
returns the return value of the given
.I command
.PP
After the first timeout happened
.B hatimerun
returns the value specified by the respective 
.I \-e
option or 
.B 99
per default. 
.B hatimerun
will always wait for the program to terminate, even if the program terminates normally after the first signal was sent, 
.B hatimerun
will return the respective error code as return value and the exit code of the command is lost.
.SH EXAMPLES
hatimerun \-t 5 sleep 10 
.RS 3
Will kill the sleep command after 5 seconds
.RE
.PP
hatimerun -k TERM -t 5 sleep 10
.RS 3
Will send the TERM signal after 5 seconds
.RE
.PP
hatimerun -k TERM -t 5 -e 100 -e 101 -t 1 sleep 10
.RS 3
Will send the TERM signal after 5 seconds, and (if the command didn't finish till then) send the KILL signal one second later (about 6 seconds after program start). Will return 100 if the program was terminated by the TERM signal or 101 if it was terminated by the KILL signal.
.RE
.PP
hatimerun -k HUP -t 1 nohup sleep 1000
.RS 3
Will send a HUP signal after one second and then wait (potentially forever) until the child terminates.
.RE
.PP
hatimerun -k TERM -t 1:30 sleep 120
.RS 3
Will send the TERM signal after one minute and 30 seconds (90 seconds).
.RE

.SH AUTHOR
Copyright (c) 2001,2003,2005-2010 by Markus Winand <mws@fatalmind.com>
.SH SEE ALSO
.IR halockrun (1)
